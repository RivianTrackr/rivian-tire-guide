(()=>{var zt=Object.defineProperty;var ne=(t,e)=>()=>(t&&(e=t(t=0)),e);var Vt=(t,e)=>{for(var r in e)zt(t,r,{get:e[r],enumerable:!0})};var ee,i,A,Q=ne(()=>{ee=typeof rtgData<"u"&&rtgData.settings&&rtgData.settings.rowsPerPage?rtgData.settings.rowsPerPage:12,i={filteredRows:[],allRows:[],currentPage:1,compareList:[],tireRatings:{},userRatings:{},userReviews:{},isLoggedIn:!1,userFavorites:new Set,VALID_SIZES:[],VALID_BRANDS:[],VALID_CATEGORIES:[],domCache:{},cardCache:new Map,cardContainer:null,isRendering:!1,pendingRender:!1,lastFilterState:null,initialRenderDone:!1,renderAnimationFrame:null,eventDelegationSetup:!1,ratingRequestQueue:[],ratingRequestTimeout:null,activeTooltip:null,serverSideMode:!1,serverSideTotal:0,serverSideFetchController:null},A={sizeIndex:new Map,brandIndex:new Map,categoryIndex:new Map,priceIndex:[],warrantyIndex:[],weightIndex:[]}});function I(t){return getComputedStyle(document.documentElement).getPropertyValue("--rtg-"+t).trim()}function L(t,e,r){var n="fa-solid",a="fa-"+t;t==="heart-outline"?(n="fa-regular",a="fa-heart"):t==="arrow-up-right"?a="fa-up-right-from-square":t==="trash"?a="fa-trash-can":t==="share"&&(a="fa-share-nodes");var o=n+" "+a;r&&(o+=" "+r);var s=e?' style="font-size:'+e+'px"':"";return'<i class="'+o+'"'+s+' aria-hidden="true"></i>'}function F(t){return typeof t!="string"?"":String(t).replace(/[&<>"'\/]/g,function(e){return{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"}[e]})}function g(t,e=200){if(typeof t!="string")return"";let r=String(t).trim();return r.length>e?r.substring(0,e):r}function l(t){return i.domCache[t]||(i.domCache[t]=document.getElementById(t)),i.domCache[t]}function fe(t,e){let r;return function(...n){clearTimeout(r),r=setTimeout(()=>t.apply(this,n),e)}}function Ie(t=22){return`<svg viewBox="0 0 24 24" width="${t}" height="${t}" aria-hidden="true"><path class="star-bg" d="${He}" fill="none" stroke="currentColor" stroke-width="1.5"/><path class="star-fill" d="${He}" fill="currentColor"/><path class="star-half" d="${He}" fill="currentColor" style="clip-path:inset(0 50% 0 0)"/></svg>`}function se(t){let e=parseFloat(t.min),r=parseFloat(t.max),a=(parseFloat(t.value)-e)/(r-e)*100;t.style.setProperty("--percent",`${a}%`)}function ge(t){t.style.backgroundColor=I("bg-primary"),t.style.color=I("text-primary"),t.style.padding="8px 16px",t.style.border="none",t.style.borderRadius="6px",t.style.cursor="pointer",t.style.fontWeight="600",t.onmouseover=()=>t.style.backgroundColor=I("accent"),t.onmouseout=()=>t.style.backgroundColor=I("bg-primary")}var He,U=ne(()=>{Q();He="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"});function he(t,e=null){if(typeof t!="string")return"";let r;return e===T.search?r=t.replace(/[<>\"'&\\]/g,"").trim():r=t.replace(/[<>\"'&\/\\]/g,"").trim(),e&&!e.test(r)?"":r.length>100?r.substring(0,100):r}function ve(t){if(typeof t!="string"||!t.trim())return"";let e=t.trim();if(!T.imageUrl.test(e))return e.match(/\.(jpg|jpeg|png|webp|gif)$/i),"";try{let r=new URL(e);return r.protocol!=="https:"||r.hostname!=="riviantrackr.com"||r.pathname.includes("..")||r.pathname.includes("//")?"":e}catch{return e.match(/\.(jpg|jpeg|png|webp|gif)$/i),""}}function it(t){if(typeof t!="string"||!t.trim())return"";let e=t.trim();if(!T.affiliateUrl.test(e))return e.startsWith("http"),"";try{let r=new URL(e);if(r.protocol!=="https:")return"";let n=["riviantrackr.com","tirerack.com","discounttire.com","amazon.com","amzn.to","costco.com","walmart.com","goodyear.com","bridgestonetire.com","michelinman.com","continental-tires.com","pirelli.com","sumitomotire.com","yokohamatire.com","coopertire.com","bfgoodrichtires.com","firestone.com","generaltire.com","hankooktire.com","kumhotire.com","nexentire.com","toyo.com","falkentire.com","nittotire.com","autozone.com","pepboys.com","ntb.com","simpletire.com","prioritytire.com","anrdoezrs.net","dpbolvw.net","jdoqocy.com","kqzyfj.com","tkqlhce.com","commission-junction.com","cj.com","linksynergy.com","click.linksynergy.com","shareasale.com","avantlink.com","impact.com","partnerize.com"],a=r.hostname.toLowerCase();return!n.some(s=>a===s||a.endsWith("."+s))||r.pathname.includes("..")?"":e}catch{return""}}function ot(t){if(typeof t!="string"||!t.trim())return"";let e=t.trim();if(!/^https:\/\/[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,}\/[a-zA-Z0-9\-\/_\.%&=?#:+@]*$/.test(e))return"";try{let n=new URL(e);if(n.protocol!=="https:")return"";let a=["riviantrackr.com","www.riviantrackr.com","youtube.com","www.youtube.com","youtu.be","tiktok.com","www.tiktok.com","instagram.com","www.instagram.com"],o=n.hostname.toLowerCase();return!a.some(c=>o===c||o.endsWith("."+c))||n.pathname.includes("..")?"":e}catch{return""}}function b(t,e,r=0){if(typeof t=="string"){if(!T.numeric.test(t))return r;t=parseFloat(t)}return typeof t!="number"||isNaN(t)?r:t<e.min||t>e.max?Math.max(e.min,Math.min(e.max,t)):t}function Me(t){if(!Array.isArray(t)||t.length<23)return null;let e=new Array(t.length);for(let r=0;r<t.length;r++){let n=t[r];typeof n=="string"?(e[r]=n.replace(/[<>\"'&]/g,"").trim(),e[r].length>500&&(e[r]=e[r].substring(0,500))):typeof n=="number"?r===6?e[r]=b(n,S.price):r===7?e[r]=b(n,S.warranty):r===8?e[r]=b(n,S.weight):e[r]=typeof n=="number"&&!isNaN(n)?n:0:e[r]=""}return!e[0]||!T.tireId.test(e[0])?null:e}var T,S,Te,ce=ne(()=>{U();T={search:/^[a-zA-Z0-9\s\-\/\.\+\*\(\)]*$/,tireId:/^[a-zA-Z0-9\-_]+$/,numeric:/^\d+(\.\d+)?$/,affiliateUrl:/^https:\/\/[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,}\/[a-zA-Z0-9\-\/_\.%&=?#:+]*$/,imageUrl:/^https:\/\/riviantrackr\.com\/.*\.(jpg|jpeg|png|webp)$/i},S={price:{min:0,max:2e3},warranty:{min:0,max:1e5},weight:{min:0,max:200},rating:{min:1,max:5},page:{min:1,max:1e3}},Te=["efficiencyGrade","price-asc","price-desc","warranty-desc","weight-asc","reviewed","rating-desc","newest","most-reviewed"]});function ct(t,e){let r=document.createElement("div");r.style.cssText="display: flex; align-items: center; gap: 6px;";let n=document.createElement("span");n.className="tire-card-spec-label",n.textContent=t;let a=document.createElement("button");return a.innerHTML=""+L("circle-info",14),a.className="info-tooltip-trigger",a.dataset.tooltipKey=e,a.setAttribute("aria-label",`More info about ${t}`),a.setAttribute("type","button"),a.style.cssText=`
    background: none;
    border: none;
    color: var(--rtg-text-muted);
    font-size: 14px;
    cursor: pointer;
    padding: 2px;
    border-radius: 50%;
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
  `,a.addEventListener("mouseenter",()=>{a.style.color=I("accent"),a.style.backgroundColor=`color-mix(in srgb, ${I("accent")} 10%, transparent)`}),a.addEventListener("mouseleave",()=>{a.style.color=I("text-muted"),a.style.backgroundColor="transparent"}),r.appendChild(n),r.appendChild(a),r}function _e(t,e){let r=document.createElement("div");r.style.cssText="display: flex; align-items: center; gap: 6px;";let n=document.createElement("span");n.textContent=t;let a=document.createElement("button");return a.innerHTML=""+L("circle-info",14),a.className="info-tooltip-trigger",a.dataset.tooltipKey=e,a.setAttribute("aria-label",`More info about ${t}`),a.setAttribute("type","button"),a.style.cssText=`
    background: none;
    border: none;
    color: var(--rtg-text-muted);
    font-size: 14px;
    cursor: pointer;
    padding: 2px;
    border-radius: 50%;
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
  `,a.addEventListener("mouseenter",()=>{a.style.color=I("accent"),a.style.backgroundColor=`color-mix(in srgb, ${I("accent")} 10%, transparent)`}),a.addEventListener("mouseleave",()=>{a.style.color=I("text-muted"),a.style.backgroundColor="transparent"}),r.appendChild(n),r.appendChild(a),r}function lt(t){st();let e=Ue[t];if(!e)return;let r=document.createElement("div");r.className="tooltip-modal-overlay",r.style.cssText=`
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    animation: fadeIn 0.2s ease;
    backdrop-filter: blur(2px);
  `;let n=document.createElement("div");n.className="tooltip-modal",n.style.cssText=`
    background: ${I("bg-primary")};
    border-radius: 12px;
    padding: 20px;
    max-width: 400px;
    width: 100%;
    color: ${I("text-light")};
    border: 1px solid #475569;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
    animation: slideUp 0.2s ease;
    position: relative;
  `;let a=document.createElement("h3");a.textContent=e.title,a.style.cssText=`
    margin: 0 0 12px 0;
    font-size: 18px;
    font-weight: 700;
    color: ${I("accent")};
  `;let o=document.createElement("p");o.innerHTML=e.content,o.style.cssText=`
    margin: 0 0 16px 0;
    line-height: 1.5;
    font-size: 14px;
    color: #e2e8f0;
  `;let s=document.createElement("button");s.innerHTML=L("xmark",18),s.style.cssText=`
    position: absolute;
    top: 16px;
    right: 16px;
    background: none;
    border: none;
    color: var(--rtg-text-muted);
    font-size: 16px;
    cursor: pointer;
    padding: 4px;
    border-radius: 4px;
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
  `,s.addEventListener("mouseenter",()=>{s.style.color=I("text-light"),s.style.backgroundColor="rgba(148, 163, 184, 0.2)"}),s.addEventListener("mouseleave",()=>{s.style.color=I("text-muted"),s.style.backgroundColor="transparent"});let c=document.createElement("button");c.textContent="Got it",c.style.cssText=`
    background: ${I("accent")};
    color: #1a1a1a;
    border: none;
    padding: 8px 16px;
    border-radius: 6px;
    font-weight: 600;
    cursor: pointer;
    font-size: 14px;
    transition: background-color 0.2s ease;
    width: 100%;
  `,c.addEventListener("mouseenter",()=>{c.style.backgroundColor=I("accent-hover")}),c.addEventListener("mouseleave",()=>{c.style.backgroundColor=I("accent")});let u=()=>st();s.addEventListener("click",u),c.addEventListener("click",u),r.addEventListener("click",f=>{f.target===r&&u()});let d=f=>{f.key==="Escape"&&(u(),document.removeEventListener("keydown",d))};document.addEventListener("keydown",d),n.appendChild(a),n.appendChild(o),n.appendChild(s),n.appendChild(c),r.appendChild(n),document.body.appendChild(r),i.activeTooltip=r,document.body.style.overflow="hidden",c.focus()}function st(){i.activeTooltip&&(i.activeTooltip.style.animation="fadeOut 0.2s ease",setTimeout(()=>{i.activeTooltip&&i.activeTooltip.parentNode&&i.activeTooltip.parentNode.removeChild(i.activeTooltip),i.activeTooltip=null,document.body.style.overflow=""},200))}var Ue,We=ne(()=>{Q();U();Ue={"Load Index":{title:"Load Index",content:"Rivian vehicles require tires with a minimum load index of 116 to safely carry the vehicle's weight. Using a lower load index can affect safety, handling, and durability."},"3PMS Rated":{title:"3PMS Rating",content:"3PMS (Three-Peak Mountain Snowflake) symbol indicates the tire meets winter traction requirements and is rated for severe snow service according to industry standards."},UTQG:{title:"UTQG Rating",content:"UTQG (Uniform Tire Quality Grading) provides standardized ratings for treadwear, temperature resistance (A, B, C), and traction performance (AA, A, B, C) to help compare tire quality."},"3PMS Filter":{title:"3PMS Rating Filter",content:"3PMS (Three-Peak Mountain Snowflake) means the tire meets winter traction requirements and is rated for severe snow service."},"EV Rated Filter":{title:"EV Rated Filter",content:"Filters for tires labeled as EV Rated in their specs or marketing. These are typically optimized for electric vehicles."},"Studded Available Filter":{title:"Studded Available Filter",content:'Filters for tires marked as "Studded Available" — these can be fitted with studs for enhanced traction on ice.'},"Officially Reviewed Filter":{title:"Officially Reviewed Filter",content:"Filters for tires that have an official review from RivianTrackr — either a written article or video review."},"Efficiency Score":{title:"Efficiency Score",content:"This Efficiency Score is a calculated score RivianTrackr created to help assist Rivian owners in identifying which tires are likely to be the most range-friendly. It uses a custom formula that factors in weight, tread depth, tire width, load range, speed rating, UTQG, tire category, and winter certification (3PMS). Lighter tires with shallower tread and less aggressive construction typically score higher. <br><br> The score is an estimate only and does not reflect real-world testing. It should not be viewed as a measure of tire quality, safety, or brand reputation."}}});function me(t){if(!t.length)return Promise.resolve();let e=t.filter(r=>typeof r=="string"&&T.tireId.test(r)&&r.length<=50);return e.length?(i.ratingRequestQueue.push(...e),i.ratingRequestTimeout&&clearTimeout(i.ratingRequestTimeout),new Promise(r=>{i.ratingRequestTimeout=setTimeout(()=>{let n=[...new Set(i.ratingRequestQueue)];if(i.ratingRequestQueue=[],typeof tireRatingAjax<"u"&&(i.isLoggedIn=tireRatingAjax.is_logged_in===!0||tireRatingAjax.is_logged_in==="1"||tireRatingAjax.is_logged_in===1),typeof tireRatingAjax>"u"){r();return}let a=new FormData;a.append("action","get_tire_ratings"),tireRatingAjax.nonce&&a.append("nonce",tireRatingAjax.nonce),n.forEach(o=>{a.append("tire_ids[]",o)}),fetch(tireRatingAjax.ajaxurl,{method:"POST",body:a}).then(o=>o.json()).then(o=>{o.success&&(i.tireRatings={...i.tireRatings,...o.data.ratings},i.userRatings={...i.userRatings,...o.data.user_ratings},o.data.user_reviews&&(i.userReviews={...i.userReviews,...o.data.user_reviews}),i.isLoggedIn=o.data.is_logged_in===!0||o.data.is_logged_in==="1"||o.data.is_logged_in===1),r()}).catch(o=>{r()})},50)})):Promise.resolve()}function Ot(t,e,r="",n=""){if(!T.tireId.test(t))return Promise.reject("Invalid tire ID");let a=b(e,S.rating);if(a!==e)return Promise.reject("Invalid rating");if(!i.isLoggedIn)return typeof tireRatingAjax<"u"&&tireRatingAjax.login_url?window.location.href=tireRatingAjax.login_url:alert("Please log in or sign up to review tires"),Promise.reject("Not logged in");if(typeof tireRatingAjax>"u"||!tireRatingAjax.nonce)return Promise.reject("Security validation failed");let o=new FormData;return o.append("action","submit_tire_rating"),o.append("tire_id",t),o.append("rating",a.toString()),o.append("nonce",tireRatingAjax.nonce),r&&o.append("review_title",r.substring(0,200)),n&&o.append("review_text",n.substring(0,5e3)),fetch(tireRatingAjax.ajaxurl,{method:"POST",body:o}).then(s=>s.json()).then(s=>{if(s.success)return i.tireRatings[t]={average:b(s.data.average_rating,{min:0,max:5}),count:b(s.data.rating_count,{min:0,max:1e4}),review_count:b(s.data.review_count,{min:0,max:1e4})},i.userRatings[t]=b(s.data.user_rating,S.rating),n&&(i.userReviews[t]={rating:a,review_title:r,review_text:n}),qt(t),s.data;throw new Error(s.data||"Failed to save review")})}function Ze(t,e=0,r=0,n=0){if(!T.tireId.test(t))return"<div>Error: Invalid tire data</div>";let a=b(e,{min:0,max:5},0),o=b(r,{min:0,max:1e4},0),s=n&&n>0?b(n,S.rating,0):0,c=i.isLoggedIn,u=a>=4.5&&o>=2,d=document.createElement("div");d.className="tire-rating-container",d.dataset.tireId=t,u&&(d.dataset.highRating="true");let f=document.createElement("div");f.className="rating-display";let y=document.createElement("div");y.className=`rating-stars ${c?"interactive":""} ${s>0?"has-user-rating":""}`,y.dataset.tireId=t,y.setAttribute("role",c?"radiogroup":"img"),y.setAttribute("aria-label",a>0?`Rating: ${a.toFixed(1)} out of 5 stars`:"No reviews yet");let p=a>0?Math.round(a*2)/2:0;for(let v=1;v<=5;v++){let w=document.createElement("span");w.className="star",w.dataset.rating=v.toString(),w.dataset.tireId=t,w.innerHTML=Ie(26),p>=v?w.classList.add("active"):p>=v-.5&&w.classList.add("active","half"),s>0&&v<=s&&w.classList.add("user-rated"),c?(w.style.cursor="pointer",w.setAttribute("role","radio"),w.setAttribute("aria-checked",s===v?"true":"false"),w.setAttribute("aria-label",`${v} star${v!==1?"s":""}`),w.setAttribute("tabindex",v===(s||1)?"0":"-1")):w.setAttribute("aria-hidden","true"),y.appendChild(w)}let m=document.createElement("div");m.className="rating-info";let h=document.createElement("span");h.className="rating-average",h.textContent=a>0?a.toFixed(1):"No reviews",m.appendChild(h),f.appendChild(y),f.appendChild(m),d.appendChild(f);let x=document.createElement("div");x.className="review-actions";let E=i.tireRatings[t]?.review_count||0;if(E>0){let v=document.createElement("button");v.className="review-action-link view-reviews-btn",v.dataset.tireId=t;let w=document.createElement("span");w.innerHTML=L("message",14),w.style.display="inline-flex",v.appendChild(w),v.appendChild(document.createTextNode(` ${E} review${E!==1?"s":""}`)),x.appendChild(v)}if(i.isLoggedIn){let v=i.userReviews[t]?.rating,w=document.createElement("button");w.className="review-action-link write-review-btn",w.dataset.tireId=t,w.textContent=v?"Edit Review":"Write a Review",x.appendChild(w)}else{let v=document.createElement("a");v.className="login-prompt",v.href=typeof tireRatingAjax<"u"?tireRatingAjax.login_url:"/wp-login.php";let w=document.createElement("span");w.innerHTML=L("pen-to-square",14),w.style.display="inline-flex",v.appendChild(w),v.appendChild(document.createTextNode(" Log in to review this tire")),x.appendChild(v)}return d.appendChild(x),d.outerHTML}function qt(t){if(!T.tireId.test(t))return;let e=document.querySelector(`[data-tire-id="${CSS.escape(t)}"] .tire-rating-container`);if(!e)return;let r=i.tireRatings[t]||{average:0,count:0},n=i.userRatings[t]||0;e.outerHTML=Ze(t,r.average,r.count,n)}function De(t,e=0){let r=document.getElementById("rtg-review-modal");r&&r.remove();let n=i.userReviews[t]||{},a=e||n.rating||0,o=n.review_title||"",s=n.review_text||"",c=document.querySelector(`[data-tire-id="${CSS.escape(t)}"].tire-card`),u=c&&c.querySelector(".tire-card-brand")?.textContent||"",d=c&&c.querySelector(".tire-card-model")?.textContent||"",f=document.createElement("div");f.id="rtg-review-modal",f.className="rtg-review-modal-overlay",f.setAttribute("role","dialog"),f.setAttribute("aria-modal","true"),f.setAttribute("aria-label","Write a review");let y=document.createElement("div");y.className="rtg-review-modal";let p=document.createElement("div");p.className="rtg-review-modal-header";let m=document.createElement("h3");m.textContent=u&&d?`Review ${u} ${d}`:"Write a Review";let h=document.createElement("button");h.className="rtg-review-modal-close",h.setAttribute("aria-label","Close"),h.innerHTML="&times;",p.appendChild(m),p.appendChild(h);let x=document.createElement("div");x.className="rtg-review-modal-stars";let E=document.createElement("label");E.textContent="Your Rating";let v=document.createElement("div");v.className="rtg-review-stars-select",v.setAttribute("role","radiogroup"),v.setAttribute("aria-label","Select rating");let w=a;for(let M=1;M<=5;M++){let N=document.createElement("span");N.className="rtg-review-star"+(M<=w?" selected":""),N.dataset.value=M,N.innerHTML=Ie(40),N.setAttribute("role","radio"),N.setAttribute("aria-checked",M===w?"true":"false"),N.setAttribute("aria-label",`${M} star${M!==1?"s":""}`),N.setAttribute("tabindex",M===(w||1)?"0":"-1"),v.appendChild(N)}let z=document.createElement("span");z.className="rtg-review-rating-text";let _=["","Poor","Fair","Good","Very Good","Excellent"];z.textContent=w>0?_[w]:"Select a rating",x.appendChild(E),x.appendChild(v),x.appendChild(z),v.addEventListener("click",M=>{let N=M.target.closest(".rtg-review-star");N&&(w=parseInt(N.dataset.value),v.querySelectorAll(".rtg-review-star").forEach((B,oe)=>{B.classList.toggle("selected",oe<w),B.setAttribute("aria-checked",oe+1===w?"true":"false")}),z.textContent=_[w]||"")}),v.addEventListener("mouseenter",M=>{let N=M.target.closest(".rtg-review-star");if(!N)return;let B=parseInt(N.dataset.value);v.querySelectorAll(".rtg-review-star").forEach((oe,Z)=>{oe.classList.toggle("hovered",Z<B)})},!0),v.addEventListener("mouseleave",()=>{v.querySelectorAll(".rtg-review-star").forEach(M=>M.classList.remove("hovered"))},!0);let W=document.createElement("div");W.className="rtg-review-field";let q=document.createElement("label");q.textContent="Review Title (optional)",q.setAttribute("for","rtg-review-title");let j=document.createElement("input");j.type="text",j.id="rtg-review-title",j.className="rtg-review-input",j.placeholder="Sum up your experience...",j.maxLength=200,j.value=o,W.appendChild(q),W.appendChild(j);let J=document.createElement("div");J.className="rtg-review-field";let de=document.createElement("label");de.textContent="Your Review (optional)",de.setAttribute("for","rtg-review-text");let R=document.createElement("textarea");R.id="rtg-review-text",R.className="rtg-review-textarea",R.placeholder="Share your experience with this tire… How does it handle, ride comfort, noise level, tread wear?",R.maxLength=5e3,R.rows=5,R.value=s;let O=document.createElement("div");O.className="rtg-review-char-count",O.textContent=`${s.length}/5000`,R.addEventListener("input",()=>{O.textContent=`${R.value.length}/5000`}),J.appendChild(de),J.appendChild(R),J.appendChild(O);let G=document.createElement("div");G.className="rtg-review-modal-footer";let re=document.createElement("button");re.className="rtg-review-btn-cancel",re.textContent="Cancel";let H=document.createElement("button");H.className="rtg-review-btn-submit",H.textContent=s?"Update Review":"Submit Review";let V=document.createElement("div");V.className="rtg-review-error",G.appendChild(V),G.appendChild(re),G.appendChild(H),y.appendChild(p),y.appendChild(x),y.appendChild(W),y.appendChild(J),y.appendChild(G),f.appendChild(y),document.body.appendChild(f),requestAnimationFrame(()=>f.classList.add("active")),j.focus();function Y(){f.classList.remove("active"),setTimeout(()=>f.remove(),200)}h.addEventListener("click",Y),re.addEventListener("click",Y),f.addEventListener("click",M=>{M.target===f&&Y()}),document.addEventListener("keydown",function M(N){N.key==="Escape"&&(Y(),document.removeEventListener("keydown",M))}),H.addEventListener("click",()=>{if(w<1||w>5){V.textContent="Please select a star rating.";return}V.textContent="",H.disabled=!0,H.textContent="Submitting...";let M=R.value.trim().length>0||j.value.trim().length>0,N=!!s||!!o;Ot(t,w,j.value.trim(),R.value.trim()).then(B=>{Y(),M&&B&&B.review_status==="pending"?Ge("Thanks! Your review has been submitted and is pending approval.","info"):Ge(N?"Your review has been updated.":"Your review has been saved!","success")}).catch(B=>{H.disabled=!1,H.textContent=s?"Update Review":"Submit Review",V.textContent=typeof B=="string"?B:"Failed to submit. Please try again."})})}function dt(t){let e=document.getElementById("rtg-reviews-drawer");e&&e.remove();let r=document.querySelector(`[data-tire-id="${CSS.escape(t)}"].tire-card`),n=r&&r.querySelector(".tire-card-brand")?.textContent||"",a=r&&r.querySelector(".tire-card-model")?.textContent||"",o=document.createElement("div");o.id="rtg-reviews-drawer",o.className="rtg-reviews-drawer-overlay",o.setAttribute("role","dialog"),o.setAttribute("aria-modal","true"),o.setAttribute("aria-label","Reviews");let s=document.createElement("div");s.className="rtg-reviews-drawer";let c=document.createElement("div");c.className="rtg-reviews-drawer-header";let u=document.createElement("h3");u.textContent=n&&a?`Reviews for ${n} ${a}`:"Reviews";let d=i.tireRatings[t]||{average:0,count:0},f=document.createElement("div");f.className="rtg-reviews-summary",d.average>0&&(f.innerHTML=`<span class="rtg-reviews-avg">${d.average.toFixed(1)}</span> <span class="rtg-reviews-stars-mini">${ut(d.average)}</span> <span class="rtg-reviews-total">${d.count} review${d.count!==1?"s":""}</span>`);let y=document.createElement("button");y.className="rtg-reviews-drawer-close",y.setAttribute("aria-label","Close"),y.innerHTML="&times;",c.appendChild(u),c.appendChild(f),c.appendChild(y);let p=document.createElement("div");p.className="rtg-reviews-content",p.innerHTML='<div class="rtg-reviews-loading">Loading reviews...</div>',s.appendChild(c),s.appendChild(p),o.appendChild(s),document.body.appendChild(o),requestAnimationFrame(()=>o.classList.add("active"));function m(){o.classList.remove("active"),setTimeout(()=>o.remove(),200)}y.addEventListener("click",m),o.addEventListener("click",h=>{h.target===o&&m()}),document.addEventListener("keydown",function h(x){x.key==="Escape"&&(m(),document.removeEventListener("keydown",h))}),Ye(t,p,1)}function Ye(t,e,r){let n=new FormData;n.append("action","get_tire_reviews"),n.append("tire_id",t),n.append("page",r.toString()),fetch(tireRatingAjax.ajaxurl,{method:"POST",body:n}).then(a=>a.json()).then(a=>{if(!a.success||!a.data.reviews.length){let o=document.createElement("div");o.className="rtg-reviews-empty";let s=document.createElement("div");s.className="rtg-reviews-empty-icon",s.textContent="✍️";let c=document.createElement("div");c.className="rtg-reviews-empty-heading",c.textContent="No reviews yet";let u=document.createElement("div");if(u.textContent="Be the first to share your experience with this tire!",o.appendChild(s),o.appendChild(c),o.appendChild(u),i.isLoggedIn){let d=document.createElement("button");d.className="rtg-reviews-empty-cta",d.textContent="Write a Review",d.addEventListener("click",()=>{let f=e.closest(".rtg-reviews-drawer-overlay");f&&(f.classList.remove("active"),setTimeout(()=>f.remove(),200)),De(t,i.userRatings[t]||0)}),o.appendChild(d)}e.innerHTML="",e.appendChild(o);return}if(e.innerHTML="",a.data.reviews.forEach(o=>{e.appendChild(Ht(o))}),a.data.total_pages>1){let o=document.createElement("div");if(o.className="rtg-reviews-pagination",r>1){let c=document.createElement("button");c.className="rtg-reviews-page-btn",c.textContent="Previous",c.addEventListener("click",()=>Ye(t,e,r-1)),o.appendChild(c)}let s=document.createElement("span");if(s.className="rtg-reviews-page-info",s.textContent=`Page ${r} of ${a.data.total_pages}`,o.appendChild(s),r<a.data.total_pages){let c=document.createElement("button");c.className="rtg-reviews-page-btn",c.textContent="Next",c.addEventListener("click",()=>Ye(t,e,r+1)),o.appendChild(c)}e.appendChild(o)}}).catch(()=>{e.innerHTML='<div class="rtg-reviews-empty">Failed to load reviews. Please try again.</div>'})}function Ht(t){let e=document.createElement("div");e.className="rtg-review-card";let r=document.createElement("div");r.className="rtg-review-card-header";let n=typeof rtgData<"u"&&rtgData.settings&&rtgData.settings.userReviewsUrl?rtgData.settings.userReviewsUrl:"",a;t.user_id&&n?(a=document.createElement("a"),a.href=n+"?reviewer="+encodeURIComponent(t.user_id),a.className="rtg-review-author rtg-review-author-link",a.textContent=t.display_name||"Anonymous"):(a=document.createElement("span"),a.className="rtg-review-author",a.textContent=t.display_name||"Anonymous");let o=document.createElement("span");o.className="rtg-review-card-stars",o.innerHTML=ut(t.rating);let s=document.createElement("span");if(s.className="rtg-review-date",s.textContent=Ut(t.updated_at||t.created_at),r.appendChild(a),r.appendChild(o),r.appendChild(s),e.appendChild(r),t.review_title){let c=document.createElement("div");c.className="rtg-review-card-title",c.textContent=t.review_title,e.appendChild(c)}if(t.review_text){let c=document.createElement("div");c.className="rtg-review-card-body",c.textContent=t.review_text,e.appendChild(c)}else{let c=document.createElement("div");c.className="rtg-review-card-body rtg-review-rating-only",c.textContent="Star rating only — no written review.",e.appendChild(c)}return e}function ut(t){let e=Math.round(t*2)/2,r="";for(let n=1;n<=5;n++){let a="rtg-mini-star";e>=n?a+=" filled":e>=n-.5&&(a+=" half-filled"),r+=`<span class="${a}">${Ie(18)}</span>`}return r}function Ut(t){let e=t&&!t.includes("T")&&!t.includes("Z")?t.replace(" ","T")+"Z":t,r=new Date(e),n=typeof tireRatingAjax<"u"&&tireRatingAjax.timezone||void 0,a=n?{timeZone:n}:{},o=new Intl.DateTimeFormat("en-CA",{...a,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),s=new Intl.DateTimeFormat("en-CA",{...a,year:"numeric",month:"2-digit",day:"2-digit"}).format(r),c=new Date(o+"T00:00:00"),u=new Date(s+"T00:00:00"),d=Math.round((c-u)/(1e3*60*60*24));if(d<=0)return"Today";if(d===1)return"Yesterday";if(d<30)return`${d} days ago`;if(d<365){let f=Math.floor(d/30);return`${f} month${f!==1?"s":""} ago`}return r.toLocaleDateString("en-US",{...a,month:"short",day:"numeric",year:"numeric"})}function Ge(t,e="success",r=4e3){let n=document.querySelector(".rtg-toast-container");n||(n=document.createElement("div"),n.className="rtg-toast-container",document.body.appendChild(n));let a=document.createElement("div");a.className=`rtg-toast rtg-toast-${e}`;let o=document.createElement("span");o.className="rtg-toast-icon",o.textContent=e==="success"?"✔":"ℹ";let s=document.createElement("span");s.textContent=t,a.appendChild(o),a.appendChild(s),n.appendChild(a),requestAnimationFrame(()=>{requestAnimationFrame(()=>a.classList.add("visible"))}),setTimeout(()=>{a.classList.remove("visible"),setTimeout(()=>a.remove(),300)},r)}var ye=ne(()=>{Q();U();ce()});function mt(){if(!i.isLoggedIn||typeof tireRatingAjax>"u")return Promise.resolve();let t=new FormData;return t.append("action","rtg_get_favorites"),t.append("nonce",tireRatingAjax.nonce),fetch(tireRatingAjax.ajaxurl,{method:"POST",body:t}).then(e=>e.json()).then(e=>{e.success&&Array.isArray(e.data.favorites)&&(i.userFavorites=new Set(e.data.favorites),Wt(),Fe())}).catch(e=>{})}function pt(t){if(!i.isLoggedIn){typeof tireRatingAjax<"u"&&tireRatingAjax.login_url&&(window.location.href=tireRatingAjax.login_url);return}if(!T.tireId.test(t))return;let e=i.userFavorites.has(t),r=e?"rtg_remove_favorite":"rtg_add_favorite";e?i.userFavorites.delete(t):i.userFavorites.add(t),Ne(t),Fe();let n=new FormData;n.append("action",r),n.append("tire_id",t),n.append("nonce",tireRatingAjax.nonce),fetch(tireRatingAjax.ajaxurl,{method:"POST",body:n}).then(a=>a.json()).then(a=>{a.success||(e?i.userFavorites.add(t):i.userFavorites.delete(t),Ne(t),Fe())}).catch(()=>{e?i.userFavorites.add(t):i.userFavorites.delete(t),Ne(t),Fe()})}function Ne(t){document.querySelectorAll(`.tire-card-fav-btn[data-tire-id="${CSS.escape(t)}"]`).forEach(r=>{let n=i.userFavorites.has(t);r.classList.toggle("is-favorite",n),r.setAttribute("aria-label",n?"Remove from favorites":"Add to favorites"),r.innerHTML=n?L("heart",16):L("heart-outline",16)})}function Wt(){document.querySelectorAll(".tire-card-fav-btn").forEach(t=>{let e=t.dataset.tireId;e&&Ne(e)})}function Fe(){let t=document.getElementById("favoritesCount");t&&(t.textContent=i.userFavorites.size>0?i.userFavorites.size:"",t.style.display=i.userFavorites.size>0?"inline-flex":"none")}var Ke=ne(()=>{Q();U();ce()});function Pe(){let t=l("compareBar"),e=l("compareCount");if(!t||!e)return;let r=Math.max(0,Math.min(4,i.compareList.length));e.textContent=`${r} of 4 tires selected`,t.style.display=r>=2?"flex":"none"}function ft(){if(!i.compareList.length)return;let t=i.compareList.filter(e=>Number.isInteger(e)&&e>=0&&e<i.allRows.length).slice(0,4);if(t.length)try{let e=typeof rtgData<"u"&&rtgData.settings&&rtgData.settings.compareUrl?rtgData.settings.compareUrl:"/tire-compare/",r=new URL(e,location.origin);r.searchParams.set("compare",t.join(",")),window.open(r.toString(),"_blank","noopener,noreferrer")}catch{}}function gt(){i.compareList=[],document.querySelectorAll(".compare-checkbox").forEach(t=>{t.checked=!1,t.disabled=!1}),Pe()}function ht(){document.querySelectorAll(".compare-checkbox:not([data-listener-attached])").forEach(e=>{e.dataset.listenerAttached="true",e.addEventListener("change",()=>{let r=parseInt(e.dataset.index);if(!(!Number.isInteger(r)||r<0)){if(e.checked){if(i.compareList.length>=4){e.checked=!1;return}i.compareList.includes(r)||i.compareList.push(r)}else i.compareList=i.compareList.filter(n=>n!==r);Pe(),document.querySelectorAll(".compare-checkbox").forEach(n=>{n.checked||(n.disabled=i.compareList.length>=4)})}})})}var Qe=ne(()=>{Q();U()});function vt(t,e){let r=ve(t);if(!r)return;let n=l("imageModal"),a=l("modalImage");if(!n||!a)return;a.src=r,a.alt=F(g(e,200)),a.onerror=()=>{let c=ve("https://riviantrackr.com/assets/tire-guide/images/image404.jpg");c&&(a.src=c,a.alt="Image not available")},n.style.display="flex",document.body.style.overflow="hidden";let o=s=>{s.key==="Escape"&&(n.style.display="none",document.body.style.overflow="",document.removeEventListener("keydown",o))};document.addEventListener("keydown",o),n.onclick=s=>{s.target===n&&(n.style.display="none",document.body.style.overflow="",document.removeEventListener("keydown",o))}}var yt=ne(()=>{U();ce()});var bt={};Vt(bt,{createSingleCard:()=>xt,observeCardImages:()=>wt,preloadNextPageImages:()=>Be,renderCards:()=>Ee});function Gt(){we||!("IntersectionObserver"in window)||(we=new IntersectionObserver(t=>{t.forEach(e=>{if(e.isIntersecting){let r=e.target,n=r.dataset.src;n&&(r.src=n,r.removeAttribute("data-src"),r.addEventListener("load",()=>{r.classList.add("rtg-img-loaded")},{once:!0})),we.unobserve(r)}})},{rootMargin:"200px 0px",threshold:0}))}function wt(t){if(we||Gt(),!we)return;t.querySelectorAll("img[data-src]").forEach(r=>we.observe(r))}function Yt(){let t=document.getElementById("rtg-skeleton-loader");t&&t.remove()}function Ee(t){Yt(),i.cardContainer||(i.cardContainer=l("tireCards")),typeof tireRatingAjax<"u"&&(i.isLoggedIn=tireRatingAjax.is_logged_in===!0||tireRatingAjax.is_logged_in==="1"||tireRatingAjax.is_logged_in===1);let e=window.matchMedia("(prefers-reduced-motion: reduce)").matches,r=window.innerWidth<=768||/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),n=e?0:r?200:300,a=e?0:r?100:150,o=new Set(t.map(m=>m[0]).filter(m=>T.tireId.test(m))),s=Array.from(i.cardContainer.children),c=new Set,u=[];s.forEach(m=>{let h=m.dataset.tireId;if(o.has(h)){c.add(h);let x=t.find(E=>E[0]===h);if(x){let E=m.querySelector(".compare-checkbox");E&&(E.dataset.index=i.allRows.indexOf(x))}}else u.push(m)}),u.forEach(m=>{e?m.parentNode&&m.parentNode.removeChild(m):(m.style.transition=`opacity ${n}ms ease, transform ${n}ms ease`,m.style.opacity="0",m.style.transform=r?"translateY(-4px) scale(0.98)":"translateY(-8px) scale(0.97)",setTimeout(()=>{m.parentNode&&m.parentNode.removeChild(m)},a))});let d=[];t.forEach(m=>{let h=m[0];if(T.tireId.test(h)&&!c.has(h)){let x=xt(m);x&&(e||(x.style.opacity="0",x.style.transform=r?"translateY(8px) scale(0.98)":"translateY(12px) scale(0.97)"),d.push(x))}});let f=document.createDocumentFragment();d.forEach(m=>f.appendChild(m)),i.cardContainer.appendChild(f),!e&&d.length>0?requestAnimationFrame(()=>{d.forEach((m,h)=>{let x=r?h*50:h*40;setTimeout(()=>{m.style.transition=`opacity ${n}ms cubic-bezier(0.16, 1, 0.3, 1), transform ${n}ms cubic-bezier(0.16, 1, 0.3, 1)`,m.style.opacity="1",m.style.transform="translateY(0) scale(1)"},x)})}):e&&d.forEach(m=>{m.style.opacity="1",m.style.transform="translateY(0) scale(1)"});let y=Array.from(i.cardContainer.children);t.some((m,h)=>{let x=m[0],E=y[h];return!E||E.dataset.tireId!==x})&&t.forEach((m,h)=>{let x=m[0];if(!T.tireId.test(x))return;let E=i.cardContainer.querySelector(`[data-tire-id="${CSS.escape(x)}"]`);if(E&&Array.from(i.cardContainer.children).indexOf(E)!==h){let w=i.cardContainer.children[h];w&&w!==E?i.cardContainer.insertBefore(E,w):w||i.cardContainer.appendChild(E)}}),ht(),i.cardContainer&&wt(i.cardContainer)}function xt(t){let[e,r,n,a,o,s,c,u,d,f,y,p,m,h,x,E,v,w,z,_,W,q,j]=t;if(!T.tireId.test(e))return null;let J=`card_${e}_${Date.now()%1e4}`,de=i.tireRatings[e]||{average:0,count:0},R=i.userRatings[e]||0,O=Ze(e,de.average,de.count,R),G=it(z),re=ve(_),H=ot(j),V=document.createElement("div");if(V.className="tire-card",V.dataset.tireId=e,g(w).toLowerCase().includes("reviewed")){let C=document.createElement("div");C.className="tire-card-badge";let k=document.createElement("div");k.className="tire-card-badge-inner";let D=document.createElement("span");D.innerHTML=L("circle-check",14),D.style.display="inline-flex",k.appendChild(D),k.appendChild(document.createTextNode("Reviewed")),C.appendChild(k),V.appendChild(C)}let Y=document.createElement("label");Y.className="tire-card-compare-overlay",Y.setAttribute("aria-label",`Compare ${F(g(a))} ${F(g(o))}`);let M=document.createElement("input");M.type="checkbox",M.className="compare-checkbox",M.dataset.id=e,M.dataset.index=i.allRows.indexOf(t).toString();let N=document.createElement("span");N.className="compare-overlay-icon",Y.appendChild(M),Y.appendChild(N);let B=document.createElement("button");B.className="tire-card-fav-btn",B.dataset.tireId=e;let oe=i.userFavorites.has(e);B.classList.toggle("is-favorite",oe),B.setAttribute("aria-label",oe?"Remove from favorites":"Add to favorites"),B.innerHTML=oe?L("heart",16):L("heart-outline",16),B.addEventListener("click",C=>{C.stopPropagation(),pt(e)});let Z=document.createElement("button");if(Z.className="tire-card-share-btn",Z.setAttribute("aria-label",`Share ${F(g(a))} ${F(g(o))}`),Z.innerHTML=L("share",16),Z.addEventListener("click",C=>{C.stopPropagation();let k=new URL(window.location.href);k.search="",k.searchParams.set("tire",e);let D=k.toString(),te=`${g(a)} ${g(o)}`;function K(){Z.innerHTML=L("check",16),Z.classList.add("copied"),setTimeout(()=>{Z.innerHTML=L("share",16),Z.classList.remove("copied")},2e3)}navigator.share?navigator.share({title:te,url:D}).catch(()=>{}):navigator.clipboard&&navigator.clipboard.writeText(D).then(K)}),re){let C=document.createElement("div");C.className="tire-card-image";let k=document.createElement("img");k.alt=`${F(g(a))} ${F(g(o))}`,k.loading="lazy",k.fetchpriority="low",k.className="rtg-lazy-img","IntersectionObserver"in window?k.dataset.src=re:k.src=re,k.onclick=()=>vt(re,`${F(g(a))} ${F(g(o))}`),C.appendChild(k),C.appendChild(Y),C.appendChild(B),C.appendChild(Z),V.appendChild(C)}else V.appendChild(Y),V.appendChild(B),V.appendChild(Z);let ue=document.createElement("div");ue.className="tire-card-body";let Ve=document.createElement("div");Ve.className="tire-card-brand",Ve.textContent=g(a),ue.appendChild(Ve);let Oe=document.createElement("div");Oe.className="tire-card-model",Oe.textContent=g(o),ue.appendChild(Oe);let at=document.createElement("div");at.innerHTML=O,ue.appendChild(at);let be=document.createElement("div");if(be.className="tire-card-tags",q){let C=g(q).trim().toUpperCase();if(["A","B","C","D","F"].includes(C)){let k={A:"#5ec095",B:"#a3e635",C:"#facc15",D:"#f97316",F:"#b91c1c"}[C],D=document.createElement("span");D.className="tire-card-eff";let te=document.createElement("span");te.className="tire-card-eff-grade",te.style.backgroundColor=k,te.textContent=C;let K=document.createElement("span");K.className="tire-card-eff-score";let pe=document.createElement("span");pe.textContent=`Efficiency (${F(g(W))}/100)`;let X=document.createElement("button");X.innerHTML=""+L("circle-info",12),X.className="info-tooltip-trigger",X.dataset.tooltipKey="Efficiency Score",X.style.cssText=`
        background: none;
        border: none;
        color: var(--rtg-text-muted);
        font-size: 12px;
        cursor: pointer;
        padding: 1px;
        border-radius: 50%;
        width: 16px;
        height: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
      `,X.addEventListener("mouseenter",()=>{X.style.color=I("accent"),X.style.backgroundColor=`color-mix(in srgb, ${I("accent")} 10%, transparent)`}),X.addEventListener("mouseleave",()=>{X.style.color=I("text-muted"),X.style.backgroundColor="transparent"}),K.appendChild(pe),K.appendChild(X),D.appendChild(te),D.appendChild(K),be.appendChild(D)}}w&&g(w).trim()&&g(w).split(/[,|]/).map(k=>k.trim()).filter(k=>k&&k.toLowerCase()!=="reviewed").forEach(k=>{let D=document.createElement("span");D.className="tire-card-tag",D.textContent=g(k,30),be.appendChild(D)}),be.children.length>0&&ue.appendChild(be);let qe=document.createElement("div");qe.className="tire-card-specs",[["Size",`${g(r)} (${g(n)}${g(n)&&!g(n).includes('"')?'"':""})`],["Category",g(s)],["Average Price",c?`$${b(c,S.price)}`:"-"],["Mileage Warranty",u?`${Number(b(u,S.warranty)).toLocaleString()} miles`:"-"],["Weight",d?`${b(d,S.weight)} lb`:"-"],["3PMS Rated",g(f)],["Tread Depth",g(y)],["Load Index",g(p)],["Max Load",m?`${b(m,{min:0,max:1e4})} lb`:"-"],["Load Range",g(h)],["Speed Rating",g(x)],["Max PSI",g(E)],["UTQG",g(v)||"None"]].forEach(([C,k])=>{let D=document.createElement("div");D.className="tire-card-spec";let te=Ue.hasOwnProperty(C),K;te?K=ct(C,C):(K=document.createElement("span"),K.className="tire-card-spec-label",K.textContent=C);let pe=document.createElement("span");pe.className="tire-card-spec-value",pe.textContent=k||"-",D.appendChild(K),D.appendChild(pe),qe.appendChild(D)}),ue.appendChild(qe),V.appendChild(ue);let Ce=document.createElement("div");if(Ce.className="tire-card-actions",G){let C=document.createElement("a");C.href=G,C.target="_blank",C.rel="noopener noreferrer",C.className="tire-card-cta tire-card-cta-primary",C.innerHTML="View Tire&nbsp;"+L("arrow-up-right",14),Ce.appendChild(C)}else{let C=document.createElement("span");C.className="tire-card-cta tire-card-cta-disabled",C.textContent="Coming Soon",Ce.appendChild(C)}if(H){let C=document.createElement("a");C.href=H,C.target="_blank",C.rel="noopener noreferrer",C.className="tire-card-cta tire-card-cta-review";let k=H.includes("youtube.com")||H.includes("youtu.be")||H.includes("tiktok.com"),D=k?"circle-play":"newspaper",te=k?"Watch Official Review":"Read Official Review";C.innerHTML=`${te}&nbsp;${L(D,14)}`,Ce.appendChild(C)}if(V.appendChild(Ce),i.cardCache.size>100){let C=i.cardCache.keys().next().value;i.cardCache.delete(C)}return i.cardCache.set(J,V.cloneNode(!0)),V}function Be(){let t=Math.ceil(i.filteredRows.length/ee);if(i.currentPage>=t)return;let e=i.currentPage*ee;i.filteredRows.slice(e,e+ee).forEach(n=>{let a=n[19],o=ve(a);if(o){let s=new Image;s.src=o}})}var we,Re=ne(()=>{Q();U();ce();We();ye();Ke();Qe();yt();we=null});Q();U();ce();var ae={nonce:null,ajaxurl:null,init(){typeof rtgData<"u"&&rtgData.settings&&(this.nonce=rtgData.settings.analyticsNonce||null,this.ajaxurl=rtgData.settings.ajaxurl||null)},track(t,e){if(!this.ajaxurl||!this.nonce)return;let r=new FormData;if(r.append("action",t),r.append("nonce",this.nonce),Object.entries(e).forEach(([n,a])=>r.append(n,a)),!(navigator.sendBeacon&&navigator.sendBeacon(this.ajaxurl,r)))try{fetch(this.ajaxurl,{method:"POST",body:r,keepalive:!0}).catch(()=>{})}catch{}},trackClick(t,e){this.track("rtg_track_click",{tire_id:t,link_type:e})},_searchDebounceTimer:null,trackSearch(t,e,r,n){clearTimeout(this._searchDebounceTimer),this._searchDebounceTimer=setTimeout(()=>{this.track("rtg_track_search",{search_query:t,filters_json:JSON.stringify(e),sort_by:r,result_count:String(n),search_type:"search"})},2e3)},trackAiSearch(t,e){this.track("rtg_track_search",{search_query:t,filters_json:"{}",sort_by:"",result_count:String(e),search_type:"ai"})}};We();Q();U();Q();U();ce();Re();ye();Q();U();ce();Re();ye();function le(){return i.serverSideMode&&typeof rtgData<"u"&&rtgData.settings&&rtgData.settings.ajaxurl}function Se(t){i.serverSideFetchController&&i.serverSideFetchController.abort(),i.serverSideFetchController=new AbortController;let e=document.querySelector("#searchInput"),r=new FormData;r.append("action","rtg_get_tires"),r.append("nonce",rtgData.settings.tireNonce),r.append("page",t||i.currentPage),r.append("search",e?e.value:""),r.append("size",l("filterSize")?.value||""),r.append("brand",l("filterBrand")?.value||""),r.append("category",l("filterCategory")?.value||""),r.append("three_pms",l("filter3pms")?.checked?"1":""),r.append("ev_rated",l("filterEVRated")?.checked?"1":""),r.append("studded",l("filterStudded")?.checked?"1":""),r.append("price_max",l("priceMax")?.value||"600"),r.append("weight_max",l("weightMax")?.value||"70");let n=l("warrantyMax"),a=n?parseInt(n.value):8e4;r.append("warranty_min",a<8e4?(8e4-a).toString():"0");let s=l("sortBy")?.value||"efficiency_score",c={efficiencyGrade:"efficiency_score"};r.append("sort",c[s]||s);let u=l("tireCount");return u&&(u.textContent="Loading..."),fetch(rtgData.settings.ajaxurl,{method:"POST",body:r,signal:i.serverSideFetchController.signal}).then(d=>d.json()).then(d=>{if(!d.success)return;let f=(d.data.rows||[]).map(Me).filter(z=>z&&z.length&&z[0]);i.filteredRows=f,i.serverSideTotal=d.data.total||0,i.currentPage=d.data.page||1,u&&(u.textContent=`Showing ${i.serverSideTotal} tire${i.serverSideTotal===1?"":"s"}`),Ee(i.filteredRows),Zt(i.serverSideTotal,d.data.per_page||ee,i.currentPage),Le();let y=l("noResults"),p=l("tireCards");i.filteredRows.length===0?(Xe(),y&&(y.style.display="block"),p&&(p.style.display="none")):(y&&(y.style.display="none"),p&&(p.style.display="grid"));let m=e?e.value:"",h={};m&&(h.search=m);let x=l("filterSize")?.value||"",E=l("filterBrand")?.value||"",v=l("filterCategory")?.value||"";x&&(h.size=x),E&&(h.brand=E),v&&(h.category=v),l("filter3pms")?.checked&&(h.three_pms=!0),l("filterEVRated")?.checked&&(h.ev_rated=!0),l("filterStudded")?.checked&&(h.studded=!0),(m||Object.keys(h).length>0)&&ae.trackSearch(m,h,s,i.serverSideTotal);let w=i.filteredRows.map(z=>z[0]).filter(Boolean);me(w)}).catch(d=>{d.name})}function Zt(t,e,r){let n=l("paginationControls");if(!n)return;n.innerHTML="";let a=Math.ceil(t/e);if(a<=1)return;let o=document.createElement("button");o.textContent="Previous",o.disabled=r<=1,ge(o),o.onclick=()=>{i.currentPage=r-1,Se(i.currentPage),Ct()},n.appendChild(o);let s=document.createElement("span");s.textContent=`Page ${r} of ${a}`,s.style.cssText=`color: ${I("text-primary")}; font-weight: 500; display: flex; align-items: center;`,n.appendChild(s);let c=document.createElement("button");c.textContent="Next",c.disabled=r>=a,ge(c),c.onclick=()=>{i.currentPage=r+1,Se(i.currentPage),Ct()},n.appendChild(c)}function Ct(){let t=l("filterTop");t&&t.scrollIntoView({behavior:"smooth"})}function Et(){let t=new FormData;return t.append("action","rtg_get_filter_options"),t.append("nonce",rtgData.settings.tireNonce),fetch(rtgData.settings.ajaxurl,{method:"POST",body:t}).then(e=>e.json()).then(e=>{if(!e.success)return;let r=e.data;i.VALID_SIZES=r.sizes||[],i.VALID_BRANDS=r.brands||[],i.VALID_CATEGORIES=r.categories||[];let n=l("filterSize");if(n){n.innerHTML="";let a=document.createElement("option");a.value="",a.textContent="All Sizes",n.appendChild(a);let o={};i.VALID_SIZES.forEach(s=>{let c=s.match(/R(\d{2})/i),u=c?c[1]:"Other";o[u]||(o[u]=[]),o[u].push(s)}),Object.keys(o).sort((s,c)=>s==="Other"?1:c==="Other"?-1:parseInt(s)-parseInt(c)).forEach(s=>{let c=document.createElement("optgroup");c.label=`${s}" Wheels`,o[s].sort().forEach(u=>{let d=document.createElement("option");d.value=u,d.textContent=u,c.appendChild(d)}),n.appendChild(c)})}xe("filterBrand",i.VALID_BRANDS),xe("filterCategory",i.VALID_CATEGORIES),ke()}).catch(e=>{})}function ie(){i.currentPage=1,i.lastFilterState=null,Se(1),Je()}function Lt(){A.sizeIndex.clear(),A.brandIndex.clear(),A.categoryIndex.clear(),A.priceIndex.length=0,A.warrantyIndex.length=0,A.weightIndex.length=0,i.allRows.forEach((t,e)=>{let[r,n,a,o,s,c,u,d,f]=t,y=g(n).toLowerCase();y&&(A.sizeIndex.has(y)||A.sizeIndex.set(y,[]),A.sizeIndex.get(y).push(e));let p=g(o).toLowerCase();p&&(A.brandIndex.has(p)||A.brandIndex.set(p,[]),A.brandIndex.get(p).push(e));let m=g(c).toLowerCase();m&&(A.categoryIndex.has(m)||A.categoryIndex.set(m,[]),A.categoryIndex.get(m).push(e));let h=b(u,S.price),x=b(d,S.warranty),E=b(f,S.weight);A.priceIndex.push({index:e,value:h}),A.warrantyIndex.push({index:e,value:x}),A.weightIndex.push({index:e,value:E})}),A.priceIndex.sort((t,e)=>t.value-e.value),A.warrantyIndex.sort((t,e)=>t.value-e.value),A.weightIndex.sort((t,e)=>t.value-e.value)}function et(t,e){let r=0,n=t.length-1;for(;r<=n;){let a=Math.floor((r+n)/2);t[a].value<=e?r=a+1:n=a-1}return new Set(t.slice(0,n+1).map(a=>a.index))}function Kt(t){let e=new Set(i.allRows.map((r,n)=>n));if(t.Size){let r=new Set(A.sizeIndex.get(t.Size.toLowerCase())||[]);e=new Set([...e].filter(n=>r.has(n)))}if(t.Brand){let r=new Set(A.brandIndex.get(t.Brand.toLowerCase())||[]);e=new Set([...e].filter(n=>r.has(n)))}if(t.Category){let r=new Set(A.categoryIndex.get(t.Category.toLowerCase())||[]);e=new Set([...e].filter(n=>r.has(n)))}if(t.PriceMax<600){let r=et(A.priceIndex,t.PriceMax);e=new Set([...e].filter(n=>r.has(n)))}if(t.WarrantyMax<8e4){let r=et(A.warrantyIndex,t.WarrantyMax);e=new Set([...e].filter(n=>r.has(n)))}if(t.WeightMax<70){let r=et(A.weightIndex,t.WeightMax);e=new Set([...e].filter(n=>r.has(n)))}return[...e].map(r=>i.allRows[r]).filter(r=>{if(t.search){let n=g(r[3]),a=g(r[4]),o=`${n} ${a}`,s=$e(n,t.search),c=$e(a,t.search),u=$e(o,t.search);if(!s&&!c&&!u)return!1}return!(t["3PMS"]&&!g(r[9]).toLowerCase().includes("yes")||t.EVRated&&!g(r[17]).toLowerCase().includes("ev rated")||t.Studded&&!g(r[17]).toLowerCase().includes("studded available")||t.Reviewed&&!g(r[23])||t.Favorites&&!i.userFavorites.has(r[0]))})}function kt(){if(i.isRendering){i.pendingRender=!0;return}i.renderAnimationFrame&&cancelAnimationFrame(i.renderAnimationFrame),i.renderAnimationFrame=requestAnimationFrame(()=>{i.isRendering=!0,tt(),setTimeout(()=>{i.isRendering=!1,i.renderAnimationFrame=null,i.pendingRender&&(i.pendingRender=!1,kt())},16)})}function Qt(t){let e=(i.currentPage-1)*ee;return t.slice(e,e+ee)}function tt(){let t=Qt(i.filteredRows),e=t.map(r=>r[0]).filter(Boolean);me(e).then(()=>{Ee(t),Jt(i.filteredRows);let r=l("noResults"),n=l("tireCards");i.filteredRows.length===0?(Xe(),r.style.display="block",n.style.display="none"):(r.style.display="none",n.style.display="grid"),"requestIdleCallback"in window?requestIdleCallback(()=>Be()):setTimeout(Be,100)})}function Jt(t){let e=l("paginationControls");e.innerHTML="";let r=Math.ceil(t.length/ee);if(r<=1)return;let n=document.createElement("button");n.textContent="Previous",n.disabled=i.currentPage===1,ge(n),n.onclick=()=>{i.currentPage--,tt(),Le();let s=l("filterTop");s&&s.scrollIntoView({behavior:"smooth"})},e.appendChild(n);let a=document.createElement("span");a.textContent=`Page ${i.currentPage} of ${r}`,a.style.cssText=`color: ${I("text-primary")}; font-weight: 500; display: flex; align-items: center;`,e.appendChild(a);let o=document.createElement("button");o.textContent="Next",o.disabled=i.currentPage===r,ge(o),o.onclick=()=>{i.currentPage++,tt(),Le();let s=l("filterTop");s&&s.scrollIntoView({behavior:"smooth"})},e.appendChild(o)}function P(){let t=document.querySelector("#searchInput"),e=l("priceMax"),r=l("warrantyMax"),n=l("weightMax"),a=l("filter3pms"),o=l("filterEVRated"),s=l("filterStudded"),c=l("filterReviewed"),u=l("filterFavorites"),d=l("filterSize"),f=l("filterBrand"),y=l("filterCategory"),p=l("sortBy"),m=t?he(t.value,T.search):"",h=e?b(e.value,S.price,600):600,x=r?b(r.value,S.warranty,8e4):8e4,E=n?b(n.value,S.weight,70):70,v={search:m.toLowerCase(),PriceMax:h,WarrantyMax:x,WeightMax:E,"3PMS":a?.checked||!1,EVRated:o?.checked||!1,Studded:s?.checked||!1,Reviewed:c?.checked||!1,Favorites:u?.checked||!1,Size:d?.value&&i.VALID_SIZES.includes(d.value)?d.value:"",Brand:f?.value&&i.VALID_BRANDS.includes(f.value)?f.value:"",Category:y?.value&&i.VALID_CATEGORIES.includes(y.value)?y.value:""},w=p?.value&&Te.includes(p.value)?p.value:"",z=JSON.stringify({...v,sortOption:w,currentPage:i.currentPage});if(i.lastFilterState===z)return;i.lastFilterState=z,i.filteredRows=Kt(v);let _={};if(v.search&&(_.search=v.search),v.Size&&(_.size=v.Size),v.Brand&&(_.brand=v.Brand),v.Category&&(_.category=v.Category),v["3PMS"]&&(_.three_pms=!0),v.EVRated&&(_.ev_rated=!0),v.Studded&&(_.studded=!0),v.PriceMax<600&&(_.price_max=v.PriceMax),v.WarrantyMax<8e4&&(_.warranty_max=v.WarrantyMax),v.WeightMax<70&&(_.weight_max=v.WeightMax),(v.search||Object.keys(_).length>0)&&ae.trackSearch(v.search||"",_,w,i.filteredRows.length),w==="rating-desc"||w==="most-reviewed"){let W=i.filteredRows.map(q=>q[0]).filter(Boolean);me(W).then(()=>{Rt(w),St()})}else Rt(w),St()}function Rt(t){if(!t||t==="efficiencyGrade"){i.filteredRows.sort((e,r)=>{let n=b(e[20],{min:0,max:100},0);return b(r[20],{min:0,max:100},0)-n});return}switch(t){case"reviewed":i.filteredRows.sort((e,r)=>{let n=g(e[17]).toLowerCase().includes("reviewed");return g(r[17]).toLowerCase().includes("reviewed")-n});break;case"rating-desc":i.filteredRows.sort((e,r)=>{let n=b(i.tireRatings[e[0]]?.average,{min:0,max:5},0),o=b(i.tireRatings[r[0]]?.average,{min:0,max:5},0)-n;if(Math.abs(o)<.01){let s=b(i.tireRatings[e[0]]?.count,{min:0,max:1e4},0),u=b(i.tireRatings[r[0]]?.count,{min:0,max:1e4},0)-s;return Math.abs(u)<.01?g(e[0]).localeCompare(g(r[0])):u}return o});break;case"most-reviewed":i.filteredRows.sort((e,r)=>{let n=b(i.tireRatings[e[0]]?.count,{min:0,max:1e4},0),o=b(i.tireRatings[r[0]]?.count,{min:0,max:1e4},0)-n;if(Math.abs(o)<.01){let s=b(i.tireRatings[e[0]]?.average,{min:0,max:5},0),u=b(i.tireRatings[r[0]]?.average,{min:0,max:5},0)-s;return Math.abs(u)<.01?g(e[0]).localeCompare(g(r[0])):u}return o});break;case"price-asc":i.filteredRows.sort((e,r)=>b(e[6],S.price,0)-b(r[6],S.price,0));break;case"price-desc":i.filteredRows.sort((e,r)=>b(r[6],S.price,0)-b(e[6],S.price,0));break;case"warranty-desc":i.filteredRows.sort((e,r)=>b(r[7],S.warranty,0)-b(e[7],S.warranty,0));break;case"weight-asc":i.filteredRows.sort((e,r)=>b(e[8],S.weight,0)-b(r[8],S.weight,0));break;case"newest":i.filteredRows.sort((e,r)=>g(r[23]).localeCompare(g(e[23])));break}}function St(){let t=l("tireCount");if(t&&(t.textContent=`Showing ${i.filteredRows.length} tire${i.filteredRows.length===1?"":"s"}`),i.initialRenderDone)i.currentPage=1;else{let e=Math.max(1,Math.ceil(i.filteredRows.length/ee));i.currentPage>e&&(i.currentPage=e),i.initialRenderDone=!0}kt(),Le(),Je()}function xe(t,e){let r=l(t);if(!r)return;[...new Set(e.map(a=>g(a).trim()))].filter(a=>a&&a.length<=100).sort((a,o)=>a.localeCompare(o)).slice(0,200).forEach(a=>{let o=document.createElement("option");o.value=a,o.textContent=a,r.appendChild(o)})}function At(t,e){let r=l(t);if(!r)return;let n=[...new Set(e.map(c=>g(c[1])).filter(c=>c))],a={};n.forEach(c=>{let u=c.match(/R(\d{2})/i),d=u?u[1]:"Other";a[d]||(a[d]=[]),a[d].push(c)});let o=Object.keys(a).sort((c,u)=>c==="Other"?1:u==="Other"?-1:parseInt(c)-parseInt(u));r.innerHTML="";let s=document.createElement("option");s.value="",s.textContent="All Sizes",r.appendChild(s),o.forEach(c=>{let u=document.createElement("optgroup");u.label=`${c}" Wheels`,a[c].sort().forEach(d=>{let f=document.createElement("option");f.value=d,f.textContent=d,u.appendChild(f)}),r.appendChild(u)})}function It(){[{id:"priceMax",label:"priceVal",format:e=>`$${e}`,bounds:S.price},{id:"warrantyMax",label:"warrantyVal",format:e=>`${Number(e).toLocaleString()} miles`,bounds:S.warranty},{id:"weightMax",label:"weightVal",format:e=>`${e} lb`,bounds:S.weight}].forEach(({id:e,label:r,format:n,bounds:a})=>{let o=l(e),s=l(r);if(o&&s){o.addEventListener("input",()=>{let u=b(o.value,a,a.max);o.value=u,s.textContent=n(u),se(o)}),o.addEventListener("input",fe(P,400));let c=b(o.value,a,a.max);s.textContent=n(c),se(o)}})}function rt(){[{id:"searchInput",value:""},{id:"filterSize",value:""},{id:"filterBrand",value:""},{id:"filterCategory",value:""},{id:"priceMax",value:600},{id:"warrantyMax",value:8e4},{id:"weightMax",value:70},{id:"sortBy",value:"rating-desc"}].forEach(({id:n,value:a})=>{let o=l(n);o&&(o.value=a)}),["filter3pms","filterEVRated","filterStudded","filterReviewed","filterFavorites"].forEach(n=>{let a=l(n);a&&(a.checked=!1)}),[{id:"priceVal",text:"$600"},{id:"warrantyVal",text:"80,000 miles"},{id:"weightVal",text:"70 lb"}].forEach(({id:n,text:a})=>{let o=l(n);o&&(o.textContent=a)}),["priceMax","warrantyMax","weightMax"].forEach(n=>{let a=l(n);a&&se(a)}),delete i.domCache.searchInput,i.lastFilterState=null,document.dispatchEvent(new CustomEvent("filtersReset")),le()?ie():P(),history.replaceState(null,"",location.pathname)}function Je(){let t=l("activeFilters");if(!t)return;let e=[],r=l("searchInput")?.value?.trim();r&&e.push({label:"Search",value:r,clear:()=>{let p=l("searchInput");p&&(p.value=""),delete i.domCache.searchInput}});let n=l("filterSize");n?.value&&e.push({label:"Size",value:n.value,clear:()=>{n.value=""}});let a=l("filterBrand");a?.value&&e.push({label:"Brand",value:a.value,clear:()=>{a.value=""}});let o=l("filterCategory");o?.value&&e.push({label:"Category",value:o.value,clear:()=>{o.value=""}});let s=l("priceMax"),c=s?parseInt(s.value):600;c<600&&e.push({label:"Price",value:"≤ $"+c,clear:()=>{s.value=600;let p=l("priceVal");p&&(p.textContent="$600"),se(s)}});let u=l("warrantyMax"),d=u?parseInt(u.value):8e4;d<8e4&&e.push({label:"Warranty",value:"≤ "+Number(d).toLocaleString()+" mi",clear:()=>{u.value=8e4;let p=l("warrantyVal");p&&(p.textContent="80,000 miles"),se(u)}});let f=l("weightMax"),y=f?parseInt(f.value):70;y<70&&e.push({label:"Weight",value:"≤ "+y+" lb",clear:()=>{f.value=70;let p=l("weightVal");p&&(p.textContent="70 lb"),se(f)}}),l("filter3pms")?.checked&&e.push({label:"3PMS",value:"Yes",clear:()=>{l("filter3pms").checked=!1}}),l("filterEVRated")?.checked&&e.push({label:"EV Rated",value:"Yes",clear:()=>{l("filterEVRated").checked=!1}}),l("filterStudded")?.checked&&e.push({label:"Studded",value:"Yes",clear:()=>{l("filterStudded").checked=!1}}),l("filterReviewed")?.checked&&e.push({label:"Reviewed",value:"Yes",clear:()=>{l("filterReviewed").checked=!1}}),l("filterFavorites")?.checked&&e.push({label:"Favorites",value:"Yes",clear:()=>{l("filterFavorites").checked=!1}}),t.innerHTML="",e.forEach(p=>{let m=document.createElement("span");m.className="filter-chip";let h=document.createElement("span");h.className="filter-chip-label",h.textContent=p.label+":";let x=document.createElement("span");x.textContent=p.value;let E=document.createElement("button");E.className="filter-chip-dismiss",E.setAttribute("aria-label","Remove "+p.label+" filter"),E.innerHTML=L("xmark",12),E.addEventListener("click",()=>{p.clear(),i.lastFilterState=null,le()?ie():P()}),m.appendChild(h),m.appendChild(x),m.appendChild(E),t.appendChild(m)})}function Xe(){let t=l("noResults");if(!t)return;let e=[],r=[],n=l("filterSize"),a=l("filterBrand"),o=l("filterCategory"),s=l("priceMax"),c=l("warrantyMax"),u=l("weightMax"),d=l("searchInput");n?.value&&r.push("Size"),a?.value&&r.push("Brand"),o?.value&&r.push("Category"),s&&parseInt(s.value)<600&&r.push("Price"),c&&parseInt(c.value)<8e4&&r.push("Warranty"),u&&parseInt(u.value)<70&&r.push("Weight"),l("filter3pms")?.checked&&r.push("3PMS"),l("filterEVRated")?.checked&&r.push("EV Rated"),l("filterStudded")?.checked&&r.push("Studded"),l("filterReviewed")?.checked&&r.push("Reviewed"),l("filterFavorites")?.checked&&r.push("Favorites"),d?.value?.trim()&&r.push("Search"),r.length>1&&e.push({label:L("rotate-left",14)+" Clear all filters",action:()=>rt()}),l("filterFavorites")?.checked&&e.push({label:L("heart-outline",14)+" Show all tires (not just favorites)",action:()=>{l("filterFavorites").checked=!1,i.lastFilterState=null,P()}}),n?.value&&e.push({label:L("ruler",14)+` Remove size filter (${F(n.value)})`,action:()=>{n.value="",i.lastFilterState=null,P()}}),a?.value&&e.push({label:L("building",14)+" Show all brands",action:()=>{a.value="",i.lastFilterState=null,P()}}),o?.value&&e.push({label:L("tags",14)+" Show all categories",action:()=>{o.value="",i.lastFilterState=null,P()}}),s&&parseInt(s.value)<600&&e.push({label:L("dollar-sign",14)+" Increase price limit to max",action:()=>{s.value=600,l("priceVal").textContent="$600",se(s),i.lastFilterState=null,P()}}),l("filter3pms")?.checked&&e.push({label:L("snowflake",14)+" Remove 3PMS filter",action:()=>{l("filter3pms").checked=!1,i.lastFilterState=null,P()}}),d?.value?.trim()&&e.push({label:L("magnifying-glass",14)+` Clear search "${F(g(d.value.trim(),30))}"`,action:()=>{d.value="",delete i.domCache.searchInput,i.lastFilterState=null,P()}});let f=e.slice(0,4);t.innerHTML="";let y=document.createElement("div");y.className="no-results-icon",y.innerHTML=L("magnifying-glass",24),t.appendChild(y);let p=document.createElement("div");p.className="no-results-title",p.textContent="No tires match your filters",t.appendChild(p);let m=document.createElement("div");if(m.className="no-results-description",r.length>0?m.textContent=`You have ${r.length} active filter${r.length>1?"s":""}: ${r.join(", ")}. Try adjusting your filters to see more options.`:m.textContent="Try adjusting the filters or search to see more options.",t.appendChild(m),f.length>0){let h=document.createElement("div");h.className="no-results-suggestions",f.forEach(x=>{let E=document.createElement("button");E.className="no-results-suggestion-btn",E.innerHTML=x.label,E.addEventListener("click",x.action),h.appendChild(E)}),t.appendChild(h)}}function Le(){let t=new URLSearchParams;i.currentPage>1&&t.set("pg",i.currentPage);let e=p=>l(p)?.value,r=p=>l(p)?.checked,n=e("searchInput");n&&T.search.test(n)&&t.set("search",n);let a=e("filterSize");a&&i.VALID_SIZES.includes(a)&&t.set("size",a);let o=e("filterBrand");o&&i.VALID_BRANDS.includes(o)&&t.set("brand",o);let s=e("filterCategory");s&&i.VALID_CATEGORIES.includes(s)&&t.set("category",s),r("filter3pms")&&t.set("3pms","1"),r("filterEVRated")&&t.set("ev","1"),r("filterStudded")&&t.set("studded","1"),r("filterReviewed")&&t.set("reviewed","1");let c=e("sortBy");c&&Te.includes(c)&&c!=="rating-desc"&&t.set("sort",c);let u=parseInt(e("priceMax"));u&&u!==600&&u>=0&&u<=2e3&&t.set("price",u);let d=parseInt(e("warrantyMax"));d&&d!==8e4&&d>=0&&d<=1e5&&t.set("warranty",d);let f=parseInt(e("weightMax"));f&&f!==70&&f>=0&&f<=200&&t.set("weight",f),l("filterFavorites")?.checked&&t.set("favorites","1");let y=t.toString()?`${location.pathname}?${t.toString()}`:`${location.pathname}`;i.initialRenderDone&&y!==location.pathname+location.search?history.pushState(null,"",y):history.replaceState(null,"",y)}function ke(){let t=new URLSearchParams(window.location.search),e=(p,m)=>{let h=document.getElementById(p);if(h&&m!==null){let x=he(m,T.search);h.value=x}},r=(p,m)=>{let h=document.getElementById(p);h&&(h.checked=m==="1")},n=t.get("search");n&&e("searchInput",n);let a=he(t.get("size"));if(a&&i.VALID_SIZES.includes(a)){let p=document.getElementById("filterSize");p&&(p.value=a)}let o=he(t.get("brand"));if(o&&i.VALID_BRANDS.includes(o)){let p=document.getElementById("filterBrand");p&&(p.value=o)}let s=he(t.get("category"));if(s&&i.VALID_CATEGORIES.includes(s)){let p=document.getElementById("filterCategory");p&&(p.value=s)}r("filter3pms",t.get("3pms")),r("filterEVRated",t.get("ev")),r("filterStudded",t.get("studded")),r("filterReviewed",t.get("reviewed")),r("filterFavorites",t.get("favorites"));let c=t.get("sort");if(c&&Te.includes(c)){let p=document.getElementById("sortBy");p&&(p.value=c)}let u=t.get("price"),d=t.get("warranty"),f=t.get("weight");if(u){let p=b(u,S.price,600),m=document.getElementById("priceMax");m&&(m.value=p)}if(d){let p=b(d,S.warranty,8e4),m=document.getElementById("warrantyMax");m&&(m.value=p)}if(f){let p=b(f,S.weight,70),m=document.getElementById("weightMax");m&&(m.value=p)}let y=t.get("pg")||t.get("page");if(y){let p=b(y,S.page,1);i.currentPage=p}else i.currentPage=1}function Tt(){let e=new URLSearchParams(window.location.search).get("compare");if(!e)return;let{updateCompareBar:r}=Xt(),n=e.split(",").map(a=>{let o=parseInt(a.trim());return b(o,{min:0,max:1e4},-1)}).filter(a=>a>=0).slice(0,4);i.compareList=n,document.querySelectorAll(".compare-checkbox").forEach(a=>{let o=parseInt(a.dataset.index);i.compareList.includes(o)&&(a.checked=!0)}),r()}function Xt(){return{updateCompareBar:Mt}}var Mt=()=>{};function _t(t){Mt=t}function Dt(){let e=new URLSearchParams(window.location.search).get("tire");if(!e||!T.tireId.test(e))return;let r=i.allRows.find(d=>d[0]===e);if(!r)return;i.filteredRows=[r],i.currentPage=1;let n=document.querySelector(".filter-wrapper"),a=document.querySelector(".sort-wrapper"),o=l("activeFilters"),s=l("paginationControls"),c=document.querySelector(".toggle-filters-btn");n&&(n.style.display="none"),a&&(a.style.display="none"),o&&(o.style.display="none"),s&&(s.style.display="none"),c&&(c.style.display="none");let u=l("tireSection");if(u){let d=document.createElement("div");d.className="tire-deeplink-bar";let f=document.createElement("a");f.href=window.location.pathname,f.className="tire-deeplink-back",f.innerHTML=L("arrow-left",14)+" View all tires",d.appendChild(f),u.parentNode.insertBefore(d,u)}}function Nt(){if(typeof rtgData>"u"||!rtgData.settings||!rtgData.settings.prefilters)return;let t=rtgData.settings.prefilters;if(t.size){let e=document.getElementById("filterSize");e&&(e.value=t.size)}if(t.brand){let e=document.getElementById("filterBrand");e&&(e.value=t.brand)}if(t.category){let e=document.getElementById("filterCategory");e&&(e.value=t.category)}if(t.sort){let e=document.getElementById("sortBy");e&&(e.value=t.sort)}if(t.three_pms){let e=document.getElementById("filter3pms");e&&(e.checked=!0)}}Q();U();ye();var Ae=!1,nt="";function er(t,e){let r=e.map(s=>({id:s[0],brand:g(s[3]).trim(),model:g(s[4]).trim()})).filter(s=>s.model).sort((s,c)=>(c.brand+c.model).length-(s.brand+s.model).length),n=[],a=new Set;for(let s of r){if(a.has(s.id))continue;let c=s.brand+" "+s.model,u=t.toLowerCase(),d=u.indexOf(c.toLowerCase()),f=c.length;d===-1&&(d=u.indexOf(s.model.toLowerCase()),f=s.model.length),d!==-1&&(n.push({idx:d,len:f,tireId:s.id}),a.add(s.id))}if(!n.length)return t;n.sort((s,c)=>c.idx-s.idx);let o=t;for(let s of n){let c=o.substring(s.idx,s.idx+s.len),u='<a href="#" class="rtg-ai-tire-link" data-tire-id="'+F(s.tireId)+'">'+c+"</a>";o=o.substring(0,s.idx)+u+o.substring(s.idx+s.len)}return o}function tr(t){let e=document.querySelector('.tire-card[data-tire-id="'+CSS.escape(t)+'"]');e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.classList.remove("rtg-ai-highlight"),e.offsetWidth,e.classList.add("rtg-ai-highlight"),setTimeout(()=>e.classList.remove("rtg-ai-highlight"),2500))}function Ft(){if(typeof rtgData>"u"||!rtgData.settings||!rtgData.settings.aiEnabled)return;let t=l("rtgAiSubmit");if(!t)return;t.addEventListener("click",rr);let e=l("searchInput");e&&e.addEventListener("input",()=>{Ae&&ze(!0)})}function rr(){let t=l("searchInput");if(!t)return;let e=t.value.trim();e&&(e===nt&&Ae||(nt=e,nr(e)))}function nr(t){let e=l("rtgAiStatus"),r=l("rtgAiSummary"),n=l("rtgAiSubmit");e&&(e.style.display="block",e.innerHTML='<div class="rtg-ai-loading"><div class="rtg-ai-spinner"></div><span>Analyzing your needs and finding the best tires...</span></div>'),r&&(r.style.display="none",r.innerHTML=""),n&&(n.disabled=!0);let a=new FormData;a.append("action","rtg_ai_recommend"),a.append("nonce",rtgData.settings.aiNonce),a.append("query",t),fetch(rtgData.settings.ajaxurl,{method:"POST",body:a,credentials:"same-origin"}).then(o=>o.json()).then(o=>{if(n&&(n.disabled=!1),!o.success){je(o.data||"Something went wrong. Please try again.");return}let{recommendations:s,summary:c,tire_rows:u}=o.data;if(!s||s.length===0){je(c||"No matching tires found. Try a different query.");return}ae.trackAiSearch(t,s.length),ar(s,c,u||[])}).catch(()=>{n&&(n.disabled=!1),je("Unable to reach the AI service. Please check your connection and try again.")})}function je(t){let e=l("rtgAiStatus");e&&(e.style.display="block",e.innerHTML='<div class="rtg-ai-error"><i class="fa-solid fa-circle-exclamation" aria-hidden="true"></i> '+F(t)+"</div>")}function ar(t,e,r){let n=l("rtgAiStatus"),a=l("rtgAiSummary");n&&(n.style.display="none",n.innerHTML="");let o=new Map,s=[];t.forEach((d,f)=>{o.set(d.tire_id,{reason:d.reason,rank:f+1}),s.push(d.tire_id)});let c=new Map;r.forEach(d=>{d&&d[0]&&c.set(d[0],d)});let u=[];if(s.forEach(d=>{let f=i.allRows.find(y=>y[0]===d);f?u.push(f):c.has(d)&&u.push(c.get(d))}),u.length===0){je("The AI recommended tires that could not be found in the current catalog. Please try a different query.");return}if(i.aiRecommendations=o,i.filteredRows=u,i.currentPage=1,Ae=!0,a){let d=er(F(e),u),f='<div class="rtg-ai-tire-chips">';u.forEach(p=>{let m=p[0],h=g(p[3]).trim(),x=g(p[4]).trim();x&&(f+='<a href="#" class="rtg-ai-tire-link rtg-ai-tire-chip" data-tire-id="'+F(m)+'">'+F(h+" "+x)+"</a>")}),f+="</div>",a.style.display="block",a.innerHTML='<div class="rtg-ai-summary-content"><div class="rtg-ai-summary-icon"><i class="fa-solid fa-wand-magic-sparkles" aria-hidden="true"></i></div><div class="rtg-ai-summary-text"><strong>AI Recommendation</strong><p>'+d+"</p>"+f+'</div><button id="rtgAiClear" class="rtg-ai-clear" type="button" aria-label="Clear AI recommendations"><i class="fa-solid fa-xmark" aria-hidden="true"></i> Clear</button></div>';let y=document.getElementById("rtgAiClear");y&&y.addEventListener("click",()=>ze()),a.addEventListener("click",p=>{let m=p.target.closest(".rtg-ai-tire-link");m&&(p.preventDefault(),tr(m.dataset.tireId))})}ir()}function ir(){let t=i.filteredRows.map(e=>e[0]).filter(Boolean);Promise.resolve().then(()=>(Re(),bt)).then(({renderCards:e})=>me(t).then(()=>{e(i.filteredRows);let r=l("tireCount");r&&(r.textContent=`AI found ${i.filteredRows.length} recommended tire${i.filteredRows.length!==1?"s":""}`);let n=l("noResults"),a=l("tireCards");i.filteredRows.length>0?(n&&(n.style.display="none"),a&&(a.style.display="grid")):(n&&(n.style.display=""),a&&(a.style.display="none"));let o=l("paginationControls");o&&(o.innerHTML="")}))}function ze(t){Ae=!1,nt="",i.aiRecommendations=null;let e=l("rtgAiSummary"),r=l("rtgAiStatus"),n=l("searchInput");e&&(e.style.display="none",e.innerHTML=""),r&&(r.style.display="none",r.innerHTML=""),n&&!t&&(n.value=""),le()?ie():P()}function Pt(){return Ae}function or(){return typeof rtgData<"u"&&rtgData.settings&&rtgData.settings.aiEnabled}var $={brands:new Map,models:new Map,categories:new Map,sizes:new Map,tags:new Map,combined:new Map};function sr(){Object.values($).forEach(t=>t.clear()),i.allRows.forEach((t,e)=>{let[r,n,a,o,s,c,u,d,f,y,p,m,h,x,E,v,w,z]=t,_=g(o).toLowerCase().trim(),W=g(s).toLowerCase().trim(),q=g(c).toLowerCase().trim(),j=g(n).toLowerCase().trim(),J=g(z).toLowerCase().trim();if(_){$.brands.has(_)||$.brands.set(_,{display:g(o).trim(),count:0,rows:[]});let R=$.brands.get(_);R.count++,R.rows.push(e)}if(W){let R=`${_} ${W}`;$.models.has(R)||$.models.set(R,{display:`${g(o).trim()} ${g(s).trim()}`,brand:g(o).trim(),model:g(s).trim(),count:0,rows:[]});let O=$.models.get(R);O.count++,O.rows.push(e)}if(q){$.categories.has(q)||$.categories.set(q,{display:g(c).trim(),count:0,rows:[]});let R=$.categories.get(q);R.count++,R.rows.push(e)}if(j){$.sizes.has(j)||$.sizes.set(j,{display:g(n).trim(),count:0,rows:[]});let R=$.sizes.get(j);R.count++,R.rows.push(e)}J&&J.split(/[,|]/).map(O=>O.trim()).filter(Boolean).forEach(O=>{$.tags.has(O)||$.tags.set(O,{display:O,count:0,rows:[]});let G=$.tags.get(O);G.count++,G.rows.includes(e)||G.rows.push(e)}),[_,W,q,j,...J.split(/[,|]/).map(R=>R.trim()).filter(Boolean)].filter(Boolean).forEach(R=>{R.length>=2&&($.combined.has(R)||$.combined.set(R,new Set),$.combined.get(R).add(e))})})}function Bt(){or()&&Pt()?ze(!0):P()}function $t(){let t=l("searchInput");if(!t)return;sr();let e=t.cloneNode(!0);t.parentNode.replaceChild(e,t),i.domCache.searchInput=e;let r=document.getElementById("rtgSearchSubmit");r&&r.addEventListener("click",()=>{Bt()}),e.addEventListener("keydown",n=>{n.key==="Enter"&&(n.preventDefault(),Bt())}),document.addEventListener("filtersReset",()=>{let n=document.querySelector("#searchInput");n&&(n.value="")}),document.addEventListener("click",n=>{n.target.textContent&&n.target.textContent.includes("Clear All")&&setTimeout(()=>{let a=document.querySelector("#searchInput");a&&(a.value="")},50)})}function $e(t,e){let r=t.toLowerCase().trim(),n=e.toLowerCase().trim();if(!n||r===n||r.startsWith(n))return!0;let a=r.split(/\s+/);return!!(n.split(/\s+/).every(c=>a.some(u=>u===c||c.length>=3&&u.startsWith(c)?!0:c.includes("/")||c.includes("-")?u===c||u.startsWith(c):!1))||n.length>=4&&r.includes(n))}ye();Re();Ke();Qe();_t(Pe);window.openComparison=ft;window.clearCompare=gt;window.resetFilters=rt;typeof tireRatingAjax<"u"&&(i.isLoggedIn=tireRatingAjax.is_logged_in===!0||tireRatingAjax.is_logged_in==="1"||tireRatingAjax.is_logged_in===1);function cr(){i.eventDelegationSetup||(document.addEventListener("click",function(t){let e=t.target.closest(".rating-stars.interactive .star");if(e){let a=e.dataset.tireId,o=parseInt(e.dataset.rating);if(!T.tireId.test(a)||!Number.isInteger(o)||o<1||o>5)return;De(a,o);return}let r=t.target.closest(".write-review-btn");if(r){let a=r.dataset.tireId;if(T.tireId.test(a)){let o=i.userRatings[a]||0;De(a,o)}return}let n=t.target.closest(".view-reviews-btn");if(n){let a=n.dataset.tireId;T.tireId.test(a)&&dt(a);return}}),document.addEventListener("mouseenter",function(t){let e=t.target.closest(".rating-stars.interactive .star");if(!e||!i.isLoggedIn)return;let r=parseInt(e.dataset.rating);if(!Number.isInteger(r)||r<1||r>5)return;e.closest(".rating-stars").querySelectorAll(".star").forEach((o,s)=>{s<r?o.classList.add("hover"):o.classList.remove("hover")})},!0),document.addEventListener("mouseleave",function(t){let e=t.target.closest(".rating-stars");if(!e)return;e.querySelectorAll(".star").forEach(n=>n.classList.remove("hover"))},!0),document.addEventListener("click",function(t){let e=t.target.closest(".tire-card-cta-primary, .tire-card-cta-review");if(!e)return;let r=e.closest(".tire-card");if(!r)return;let n=r.dataset.tireId;if(!n||!T.tireId.test(n))return;let a="purchase";e.classList.contains("tire-card-cta-review")&&(a="review"),ae.trackClick(n,a)}),document.addEventListener("keydown",function(t){let e=t.target.closest(".rating-stars.interactive .star");if(!e)return;let r=e.closest(".rating-stars"),n=Array.from(r.querySelectorAll(".star")),a=n.indexOf(e);if(t.key==="ArrowRight"||t.key==="ArrowUp"){t.preventDefault();let o=n[Math.min(a+1,n.length-1)];o.setAttribute("tabindex","0"),e.setAttribute("tabindex","-1"),o.focus()}else if(t.key==="ArrowLeft"||t.key==="ArrowDown"){t.preventDefault();let o=n[Math.max(a-1,0)];o.setAttribute("tabindex","0"),e.setAttribute("tabindex","-1"),o.focus()}else(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),e.click())}),i.eventDelegationSetup=!0)}function jt(){let t=le(),e=t?ie:P,r=t?fe(ie,500):fe(P,500);if(t||(i.VALID_SIZES=[...new Set(i.allRows.map(a=>String(a[1]||"").trim()))].filter(Boolean),i.VALID_BRANDS=[...new Set(i.allRows.map(a=>String(a[3]||"").trim()))].filter(Boolean),i.VALID_CATEGORIES=[...new Set(i.allRows.map(a=>String(a[5]||"").trim()))].filter(Boolean),At("filterSize",i.allRows),xe("filterBrand",i.allRows.map(a=>a[3])),xe("filterCategory",i.allRows.map(a=>a[5]))),[{id:"searchInput",listener:r},{id:"filterSize",listener:e},{id:"filterBrand",listener:e},{id:"filterCategory",listener:e},{id:"filter3pms",listener:e},{id:"filterEVRated",listener:e},{id:"filterStudded",listener:e},{id:"filterReviewed",listener:e},{id:"filterFavorites",listener:e}].forEach(({id:a,listener:o})=>{let s=l(a);s&&s.addEventListener("input",o)}),Nt(),ke(),Tt(),It(),cr(),$t(),Ft(),t)["priceMax","warrantyMax","weightMax"].forEach(o=>{let s=l(o);s&&s.addEventListener("input",fe(ie,500))}),Et().then(()=>{Se(i.currentPage)});else{Lt(),P(),Dt();let a=l("tireCount");a&&(a.textContent=`Showing ${i.filteredRows.length} tire${i.filteredRows.length!==1?"s":""}`)}mt()}window.addEventListener("popstate",function(){le()||(i.lastFilterState=null,ke(),P())});ae.init();(function(){let e=document.getElementById("tireCards");if(!e||e.children.length>0)return;let r=typeof rtgData<"u"&&rtgData.settings&&rtgData.settings.rowsPerPage||12,n=document.createElement("div");n.className="rtg-skeleton-grid",n.id="rtg-skeleton-loader";for(let a=0;a<Math.min(r,12);a++)n.innerHTML+='<div class="rtg-skeleton-card"><div class="rtg-skeleton-shimmer rtg-skeleton-image"></div><div class="rtg-skeleton-shimmer rtg-skeleton-title"></div><div class="rtg-skeleton-shimmer rtg-skeleton-subtitle"></div><div class="rtg-skeleton-row"><div class="rtg-skeleton-shimmer rtg-skeleton-badge"></div><div class="rtg-skeleton-shimmer rtg-skeleton-badge"></div></div><div class="rtg-skeleton-shimmer rtg-skeleton-text"></div><div class="rtg-skeleton-shimmer rtg-skeleton-text-short"></div><div class="rtg-skeleton-shimmer rtg-skeleton-stars"></div></div>';e.appendChild(n)})();typeof rtgData<"u"&&rtgData.settings&&rtgData.settings.serverSide?(i.serverSideMode=!0,typeof tireRatingAjax<"u"&&(i.isLoggedIn=tireRatingAjax.is_logged_in===!0||tireRatingAjax.is_logged_in==="1"||tireRatingAjax.is_logged_in===1),i.allRows=[],i.filteredRows=[],jt()):typeof rtgData<"u"&&rtgData.tires&&Array.isArray(rtgData.tires)&&(i.allRows=rtgData.tires.map(Me).filter(t=>t&&t.length&&t[0]),i.filteredRows=i.allRows,typeof tireRatingAjax<"u"&&(i.isLoggedIn=tireRatingAjax.is_logged_in===!0||tireRatingAjax.is_logged_in==="1"||tireRatingAjax.is_logged_in===1),jt());document.addEventListener("click",t=>{let e=l("compareModal"),r=e?.querySelector("div");e?.style.display==="flex"&&e.contains(t.target)&&!r?.contains(t.target)&&(e.style.display="none",document.body.style.overflow="")});document.addEventListener("DOMContentLoaded",()=>{function t(){document.querySelectorAll(".switch-label").forEach(u=>{let d=u.querySelector('input[type="checkbox"]'),f=u.querySelector(".switch-text");if(d&&f){let y=d.id,p=null,m="";switch(y){case"filter3pms":p="3PMS Filter",m="3PMS Rated";break;case"filterEVRated":p="EV Rated Filter",m="EV Rated";break;case"filterStudded":p="Studded Available Filter",m="Studded Available";break}if(p){let h=_e(m,p);f.innerHTML="",f.appendChild(h)}}})}function e(){setTimeout(()=>{[{selector:"filter3pms",label:"3PMS Rated",key:"3PMS Filter"},{selector:"filterEVRated",label:"EV Rated",key:"EV Rated Filter"},{selector:"filterStudded",label:"Studded Available",key:"Studded Available Filter"}].forEach(({selector:u,label:d,key:f})=>{let y=document.querySelector(`.switch-label:has(input#${u}) .switch-text`);if(y){let p=_e(d,f);y.innerHTML="",y.appendChild(p)}else{let p=document.getElementById(u);if(p){let m=p.parentElement.querySelector(".switch-text");if(m){let h=_e(d,f);m.innerHTML="",m.appendChild(h)}}}})},100)}t(),e(),document.addEventListener("click",c=>{let u=c.target.closest(".info-tooltip-trigger");if(u){c.preventDefault(),c.stopPropagation();let d=u.dataset.tooltipKey;lt(d,u)}});let r=l("sortBy");r&&r.addEventListener("input",P);let n=l("toggleFilters"),a=l("mobileFilterContent");n&&a&&(n.setAttribute("aria-expanded","false"),n.setAttribute("aria-controls","mobileFilterContent"),n.addEventListener("click",()=>{let c=a.classList.toggle("open");n.textContent=c?"Hide Filters":"Show Filters",n.setAttribute("aria-expanded",c?"true":"false")}));let o=l("wheelDrawerTrigger"),s=l("wheelDrawer");o&&s&&(o.setAttribute("aria-expanded","false"),o.setAttribute("aria-controls","wheelDrawer"),o.addEventListener("click",()=>{let c=s.style.display!=="block";s.style.display=c?"block":"none",o.setAttribute("aria-expanded",c?"true":"false")}))});})();
